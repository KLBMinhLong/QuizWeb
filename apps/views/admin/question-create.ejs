<%- include('./partials/header', { pageTitle: 'Tạo câu hỏi mới' , activePage: 'question-create' , breadcrumb: 'Tạo mới'
  , user: typeof user !=='undefined' ? user : null }) %>

  <% if (typeof error !=='undefined' && error) { %>
    <div class="alert alert-error">
      <%= error %>
    </div>
    <% } %>

      <div class="admin-content__header">
        <div>
          <h1 class="admin-content__title">Tạo câu hỏi mới</h1>
          <p class="admin-content__subtitle">Thêm câu hỏi mới vào ngân hàng đề</p>
        </div>
        <div class="admin-content__actions">
          <a href="/admin/questions" class="admin-btn admin-btn--secondary">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="19" y1="12" x2="5" y2="12"></line>
              <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
            Quay lại
          </a>
        </div>
      </div>

      <div class="admin-panel">
        <div class="admin-panel__header">
          <h3 class="admin-panel__title">Thông tin câu hỏi</h3>
        </div>
        <div class="admin-panel__body">
          <form method="post" action="/admin/questions/create">
            <input type="hidden" id="answers-json" name="answers" value="[]" />

            <div class="admin-form-inline">
              <div class="admin-form-group">
                <label class="admin-form-label">Môn học <span style="color: #dc2626;">*</span></label>
                <select name="subjectId" id="subjectId" class="admin-form-select" required>
                  <option value="">-- Chọn môn học --</option>
                  <% if (subjects && subjects.length> 0) { %>
                    <% subjects.forEach(function(s) { %>
                      <option value="<%= s._id %>">
                        <%= s.name %>
                      </option>
                      <% }) %>
                        <% } %>
                </select>
              </div>

              <div class="admin-form-group">
                <label class="admin-form-label">Độ khó <span style="color: #dc2626;">*</span></label>
                <select name="difficulty" id="difficulty" class="admin-form-select" required>
                  <option value="easy">Dễ</option>
                  <option value="medium" selected>Trung bình</option>
                  <option value="hard">Khó</option>
                </select>
              </div>

              <div class="admin-form-group">
                <label class="admin-form-label">Loại câu hỏi <span style="color: #dc2626;">*</span></label>
                <select name="type" id="type" class="admin-form-select" required>
                  <option value="">-- Chọn loại câu hỏi --</option>
                  <option value="single_choice">Trắc nghiệm một lựa chọn</option>
                  <option value="multiple_choice">Trắc nghiệm nhiều lựa chọn</option>
                  <option value="true_false">Đúng/Sai</option>
                  <option value="fill_in_blank">Điền từ</option>
                  <option value="matching">Nối cặp</option>
                </select>
              </div>
            </div>

            <div class="admin-form-group">
              <label class="admin-form-label">Nội dung câu hỏi <span style="color: #dc2626;">*</span></label>
              <textarea name="content" id="content" class="admin-form-input" rows="4"
                placeholder="Nhập nội dung câu hỏi..." required style="resize: vertical;"></textarea>
            </div>

            <div class="admin-form-group">
              <label class="admin-form-label">URL hình ảnh/video (tùy chọn)</label>
              <input type="url" name="mediaUrl" id="mediaUrl" class="admin-form-input" placeholder="https://..." />
            </div>

            <div class="admin-form-group" id="answers-container">
              <!-- Dynamic answers fields will be inserted here -->
            </div>

            <div style="display: flex; gap: var(--spacing-md); margin-top: var(--spacing-xl);">
              <button type="submit" class="admin-btn admin-btn--primary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                Tạo câu hỏi
              </button>
              <a href="/admin/questions" class="admin-btn admin-btn--secondary">Hủy</a>
            </div>
          </form>
        </div>
      </div>

      <script src="/static/js/admin-questions.js"></script>

      <%- include('./partials/footer') %>