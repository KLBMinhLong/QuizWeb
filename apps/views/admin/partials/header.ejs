<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
        <%= typeof pageTitle !=='undefined' ? pageTitle + ' - ' : '' %>Admin Panel | OnThiTracNghiem
    </title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/theme.css" />
    <link rel="stylesheet" href="/static/css/style.css" />
    <link rel="stylesheet" href="/static/css/admin.css" />
</head>

<body>
    <div class="admin-layout">
        <!-- Sidebar Overlay (Mobile) -->
        <div class="admin-sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        <!-- Sidebar -->
        <aside class="admin-sidebar" id="sidebar">
            <!-- Toggle button for collapse -->
            <button class="admin-sidebar__toggle" id="sidebarCollapseBtn" onclick="toggleCollapse()"
                title="Thu gọn/Mở rộng">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>

            <div class="admin-sidebar__header">
                <a href="/" class="admin-sidebar__logo">
                    <div class="admin-sidebar__logo-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
                            <path d="M6 12v5c3 3 9 3 12 0v-5"></path>
                        </svg>
                    </div>
                    <span class="admin-sidebar__logo-text">QuizWeb</span>
                    <span class="admin-sidebar__logo-badge">Admin</span>
                </a>
            </div>

            <nav class="admin-sidebar__nav">
                <div class="admin-nav__section">
                    <div class="admin-nav__label">Tổng quan</div>
                    <ul class="admin-nav__menu">
                        <li class="admin-nav__item">
                            <a href="/admin" data-tooltip="Dashboard"
                                class="admin-nav__link <%= typeof activePage !== 'undefined' && activePage === 'dashboard' ? 'admin-nav__link--active' : '' %>">
                                <svg class="admin-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                                    <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                                    <rect x="14" y="14" width="7" height="7" rx="1"></rect>
                                    <rect x="3" y="14" width="7" height="7" rx="1"></rect>
                                </svg>
                                <span class="admin-nav__text">Dashboard</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="admin-nav__section">
                    <div class="admin-nav__label">Quản lý nội dung</div>
                    <ul class="admin-nav__menu">
                        <li class="admin-nav__item">
                            <a href="/admin/subjects" data-tooltip="Môn học"
                                class="admin-nav__link <%= typeof activePage !== 'undefined' && activePage === 'subjects' ? 'admin-nav__link--active' : '' %>">
                                <svg class="admin-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                                </svg>
                                <span class="admin-nav__text">Môn học</span>
                            </a>
                        </li>
                        <li class="admin-nav__item">
                            <a href="/admin/questions" data-tooltip="Câu hỏi"
                                class="admin-nav__link <%= typeof activePage !== 'undefined' && (activePage === 'questions' || activePage === 'question-create' || activePage === 'question-edit' || activePage === 'question-import') ? 'admin-nav__link--active' : '' %>">
                                <svg class="admin-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                </svg>
                                <span class="admin-nav__text">Câu hỏi</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="admin-nav__section">
                    <div class="admin-nav__label">Quản lý người dùng</div>
                    <ul class="admin-nav__menu">
                        <li class="admin-nav__item">
                            <a href="/admin/users" data-tooltip="Người dùng"
                                class="admin-nav__link <%= typeof activePage !== 'undefined' && activePage === 'users' ? 'admin-nav__link--active' : '' %>">
                                <svg class="admin-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span class="admin-nav__text">Người dùng</span>
                            </a>
                        </li>
                        <li class="admin-nav__item">
                            <a href="/admin/roles" data-tooltip="Phân quyền"
                                class="admin-nav__link <%= typeof activePage !== 'undefined' && activePage === 'roles' ? 'admin-nav__link--active' : '' %>">
                                <svg class="admin-nav__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                </svg>
                                <span class="admin-nav__text">Phân quyền</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <div class="admin-sidebar__footer">
                <div class="admin-sidebar__user">
                    <div class="admin-sidebar__avatar">
                        <%= typeof user !=='undefined' && user ? user.username.charAt(0).toUpperCase() : 'A' %>
                    </div>
                    <div class="admin-sidebar__user-info">
                        <div class="admin-sidebar__user-name">
                            <%= typeof user !=='undefined' && user ? user.username : 'Admin' %>
                        </div>
                        <div class="admin-sidebar__user-role">Administrator</div>
                    </div>
                    <a href="/auth/logout" class="admin-sidebar__logout" title="Đăng xuất">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main" id="adminMain">
            <header class="admin-topbar">
                <div class="admin-topbar__left">
                    <button class="admin-topbar__toggle" onclick="toggleSidebar()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <nav class="admin-topbar__breadcrumb">
                        <a href="/">Trang chủ</a>
                        <span>›</span>
                        <a href="/admin">Quản trị</a>
                        <% if (typeof breadcrumb !=='undefined' && breadcrumb) { %>
                            <span>›</span>
                            <span class="admin-topbar__breadcrumb-current">
                                <%= breadcrumb %>
                            </span>
                            <% } %>
                    </nav>
                </div>
                <div class="admin-topbar__right">
                    <a href="/" class="admin-topbar__action" title="Về trang chủ">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                        </svg>
                    </a>
                </div>
            </header>

            <div class="admin-content">